import { marked } from 'marked';

export async function copyMarkdownToClipboard(markdown: string): Promise<string> {
  // Convert Markdown → HTML
  const htmlContent = marked.parse(markdown);

  try {
    const htmlBlob = new Blob([htmlContent], { type: 'text/html' });
    const textBlob = new Blob([markdown], { type: 'text/plain' });

    const clipboardItem = new ClipboardItem({
      'text/html': htmlBlob,
      'text/plain': textBlob
    });

    await navigator.clipboard.write([clipboardItem]);
    console.log('✅ Copied as rich text');
  } catch (err) {
    console.error('❌ Copy failed:', err);
  }

  // Return the final HTML string
  return htmlContent;
}
